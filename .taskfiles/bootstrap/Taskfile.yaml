---
# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: '3'

tasks:
  default:
    desc: Bootstrap Talos nodes, NAS node, and Cluster apps
    summary: |
      set `nas: true` if you'd like to wipe and re-initialize the cluster on the nas as well
    cmd: bash {{.BOOTSTRAP_DIR}}/scripts/bootstrap-cluster.sh
    env:
      ROOK_DISK_0: SPCC M.2 PCIe SSD
      ROOK_DISK_1: SPCC M.2 SSD
      ADD_NAS: '{{.ADD_NAS}}'
    requires:
      vars: [nas]
    preconditions:
      - talosctl config info
      - test -f {{.TALHELPER_DIR}}/talconfig.yaml
      - test -f {{.BOOTSTRAP_DIR}}/scripts/bootstrap-cluster.sh
